<%= render "header" %>

<div class="article bg-light mt-5 rounded shadow">
<h1><%= @article.title %></h1><br>

<span>Posted by <%= link_to @user.email %></span>

<% if user_signed_in? %>
  <% if current_user != @user %>
    <% if current_user.following?(@user) %>
      <%= link_to "Unfollow", friendships_path(user_id: @user.id), data: { turbo_method: :delete }, class: "btn btn-danger btn-sm" %>
    <% else %>
      <%= link_to "Follow", friendships_path(user_id: @article.user_id), data: { turbo_method: :post }, class: "btn btn-primary btn-sm" %>
    <% end %>
  <% end %>
<% end %>
<br><br>

<p><%= @article.body %></p>

<% if user_signed_in? %>
  <% if current_user.id == @article.user_id %>
    <%= link_to "Edit", edit_article_path(@article), class: "btn btn-warning btn-sm" %></li>
    <%= link_to "Delete", article_path(@article), data: {
                        turbo_method: :delete,
                        turbo_confirm: "Are you sure?"
                      },
                      class: "btn btn-danger btn-sm" %>
  <% end %>
<% end %>
</div>

<br><br>
<div class="container">
  <h3>Comments:</h2>
  <%= render @article.comments %>

  <% if user_signed_in? %> 
    <% if current_user.following?(@user) %>
      <h5>Add a comment:</h2>
      <%= render 'comments/form' %>
    <% else %>
      <h5>You must be following this user to add a comment.</h5>
    <% end %>
  <% else %>
    <p>If you want to comment, please <%= link_to "sign in", new_user_session_path %> into your account and make sure to 'Follow' this author.</p>
  <% end %>

  <%= link_to "Back", :back, class: "btn btn-dark" %>
</div>
<%= render "footer" %>
